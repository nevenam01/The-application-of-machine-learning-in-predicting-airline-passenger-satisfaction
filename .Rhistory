length(unique(data$Flight.Distance))
data$Customer.Type<-as.factor(data$Customer.Type)
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
#Varijabla ID ima 129880 razlicitih vrednosti, sto je jednako broju opservacija
#Ova varijabla je dakle jedinstvena za svaku opservaciju i ne moze direktno uticati na zadovoljstvo putnika
#Stoga je odmah izbacujemo iz daljeg razmatranja
length(unique(data$ID))
data$ID<-NULL
length(unique(data$Flight.Distance))
data$ID<-NULL
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
data$Gender<-as.factor(data$Gender)-1
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
data$Gender<-as.factor(data$Gender)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
length(unique(data$ID))
data$ID<-NULL
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
#Varijabla Age(predstavlja broj godina putnika) sadrzi 25 razlicitih vrednosti
#Sadrzi putnike starosti 7-80 godina, kao i 25 putnika starosti 85 godina
length(unique(data$Age))
table(data$Age)
#Varijabla Customer.Type sadrzi 2 vrednosti(First-time i Returning), pri cemu znacajno vise putnika pripada tipu Returning
#Returning su putnici koji su vec putovali aviokompanijom
length(unique(data$Customer.Type))
table(data$Customer.Type)
data$Customer.Type<-as.factor(data$Customer.Type)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
#Varijabla Type.of.Travel sadrzi 2 vrednosti Business i Personal, dakle pretvaramo varijablu u faktorsku
#(vise od duplo vise putnika leti iz poslovnih razloga(Business))
length(unique(data$Type.of.Travel))
table(data$Type.of.Travel)
data$Type.of.Travel<-as.factor(data$Type.of.Travel)
#Varijabla Class sadrzi 3 razlicite vrednosti(Business,Economy i Economy Plus)
length(unique(data$Class))
table(data$Class)
data$Class<-factor(data$Class, levels=c("Economy","Economy Plus","Business"))
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
length(unique(data$Flight.Distance))
table(data$Flight.Distance)
length(unique(data$Departure.Delay))
#numericka varijabla sa 466 razlicitih vrednosti
length(unique(data$Flight.Distance))
#numericka varijabla sa 466 razlicitih vrednosti (predstavlja kasnjenje prilikom polaska izrazeno u minutima)
length(unique(data$Arrival.Delay))
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Class)
length(unique(data$Departure.and.Arrival.Time.Convenience))
length(unique(data$Ease.of.Online.Booking))
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
data$Satisfaction<-as.factor(data$Satisfaction)
str(data)
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
table(data$Ease.of.Online.Booking)
#naredne varijable (od Departure and Arrival convience do Baggage Handling) su predstavljene brojevima 0-5,
#0 vrednosti su "not applicable" tj NA, a 1-5 su ocene od najnize do najvise
#kod svake varijable cemo vrednosti 0
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
median<-median(data$Departure.and.Arrival.Time.Convenience, na.rm=T)
median
data[data$Departure.and.Arrival.Time.Convenience==0]<-NA
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
#Varijabla ID ima 129880 razlicitih vrednosti, sto je jednako broju opservacija
#Ova varijabla je dakle jedinstvena za svaku opservaciju i ne moze direktno uticati na zadovoljstvo putnika
#Stoga je odmah izbacujemo iz daljeg razmatranja
length(unique(data$ID))
data$ID<-NULL
#varijabla Gender(pol putnika) ima 2  razlicite vrednosti(Female i Male), dakle pretvaramo varijablu u faktorsku
#takodje vidimo da je prilicno dobro uravnotezen broj zena i muskaraca u dataset-u,
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#Varijabla Age(predstavlja broj godina putnika) sadrzi 75 razlicitih vrednosti
#Sadrzi putnike starosti 7-80 godina, kao i 25 putnika starosti 85 godina
length(unique(data$Age))
table(data$Age)
#Varijabla Customer.Type sadrzi 2 vrednosti(First-time i Returning),dakle pretvaramo varijablu u faktorsku
#pri cemu znacajno vise putnika pripada tipu Returning
#Returning su putnici koji su vec putovali aviokompanijom
length(unique(data$Customer.Type))
table(data$Customer.Type)
data$Customer.Type<-as.factor(data$Customer.Type)
#Varijabla Type.of.Travel sadrzi 2 vrednosti Business i Personal, dakle pretvaramo varijablu u faktorsku
#(vise od duplo vise putnika leti iz poslovnih razloga(Business))
length(unique(data$Type.of.Travel))
table(data$Type.of.Travel)
data$Type.of.Travel<-as.factor(data$Type.of.Travel)
#Varijabla Class sadrzi 3 razlicite vrednosti(Business,Economy i Economy Plus)
length(unique(data$Class))
table(data$Class)
#ova varijabla je ordinalna, tako da cemo je zadrzati i pretvoriti u faktorsku iako nije binarna
data$Class<-factor(data$Class, levels=c("Economy","Economy Plus","Business"))
#numericka varijabla sa 3821 razlicite vrednosti (predstavlja duzinu leta izrazenu u miljama)
length(unique(data$Flight.Distance))
#numericka varijabla sa 466 razlicitih vrednosti (predstavlja kasnjenje prilikom poletanja sa aerodroma izrazeno u minutima)
length(unique(data$Departure.Delay))
#numericka varijabla sa 473 razlicite vrednosti (predstavlja kasnjenje prilikom sletanja na aerodrom izrazeno u minutima)
length(unique(data$Arrival.Delay))
#naredne varijable (od Departure and Arrival convience do Baggage Handling) su predstavljene brojevima 0-5,
#0 vrednosti su "not applicable" tj NA, a 1-5 su ocene od najnize do najvise
#kod svake varijable cemo vrednosti 0 zameniti sa medijanom
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
data[data$Departure.and.Arrival.Time.Convenience==0]<-NA
data$Departure.and.Arrival.Time.Convenience[data$Departure.and.Arrival.Time.Convenience==0]<-NA
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
#Varijabla ID ima 129880 razlicitih vrednosti, sto je jednako broju opservacija
#Ova varijabla je dakle jedinstvena za svaku opservaciju i ne moze direktno uticati na zadovoljstvo putnika
#Stoga je odmah izbacujemo iz daljeg razmatranja
length(unique(data$ID))
data$ID<-NULL
#varijabla Gender(pol putnika) ima 2  razlicite vrednosti(Female i Male), dakle pretvaramo varijablu u faktorsku
#takodje vidimo da je prilicno dobro uravnotezen broj zena i muskaraca u dataset-u,
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#Varijabla Age(predstavlja broj godina putnika) sadrzi 75 razlicitih vrednosti
#Sadrzi putnike starosti 7-80 godina, kao i 25 putnika starosti 85 godina
length(unique(data$Age))
table(data$Age)
#Varijabla Customer.Type sadrzi 2 vrednosti(First-time i Returning),dakle pretvaramo varijablu u faktorsku
#pri cemu znacajno vise putnika pripada tipu Returning
#Returning su putnici koji su vec putovali aviokompanijom
length(unique(data$Customer.Type))
table(data$Customer.Type)
data$Customer.Type<-as.factor(data$Customer.Type)
#Varijabla Type.of.Travel sadrzi 2 vrednosti Business i Personal, dakle pretvaramo varijablu u faktorsku
#(vise od duplo vise putnika leti iz poslovnih razloga(Business))
length(unique(data$Type.of.Travel))
table(data$Type.of.Travel)
data$Type.of.Travel<-as.factor(data$Type.of.Travel)
#Varijabla Class sadrzi 3 razlicite vrednosti(Business,Economy i Economy Plus)
length(unique(data$Class))
table(data$Class)
#ova varijabla je ordinalna, tako da cemo je zadrzati i pretvoriti u faktorsku iako nije binarna
data$Class<-factor(data$Class, levels=c("Economy","Economy Plus","Business"))
#numericka varijabla sa 3821 razlicite vrednosti (predstavlja duzinu leta izrazenu u miljama)
length(unique(data$Flight.Distance))
#numericka varijabla sa 466 razlicitih vrednosti (predstavlja kasnjenje prilikom poletanja sa aerodroma izrazeno u minutima)
length(unique(data$Departure.Delay))
#numericka varijabla sa 473 razlicite vrednosti (predstavlja kasnjenje prilikom sletanja na aerodrom izrazeno u minutima)
length(unique(data$Arrival.Delay))
#naredne varijable (od Departure and Arrival convience do Baggage Handling) su predstavljene brojevima 0-5,
#0 vrednosti su "not applicable" tj NA, a 1-5 su ocene od najnize do najvise
#kod svake varijable cemo vrednosti 0 zameniti sa medijanom
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
data$Departure.and.Arrival.Time.Convenience[data$Departure.and.Arrival.Time.Convenience==0]<-NA
table(data$Departure.and.Arrival.Time.Convenience)
median<-median(data$Departure.and.Arrival.Time.Convenience, na.rm=T)
data$Departure.and.Arrival.Time.Convenience[is.na(data$Departure.and.Arrival.Time.Convenience)]<-median
table(data$Departure.and.Arrival.Time.Convenience)
length(unique(data$Ease.of.Online.Booking))
table(data$Ease.of.Online.Booking)
data$Ease.of.Online.Booking[data$Ease.of.Online.Booking==0]<-NA
median2<-median(data$Ease.of.Online.Booking, na.rm=T)
median2
data$Ease.of.Online.Booking[is.na(data$Ease.of.Online.Booking)]<-median2
table(data$Ease.of.Online.Booking)
apply(data,MARGIN = 2,function(x) sum(is.na(x))) #Arrival.Delay 393
apply(data,MARGIN = 2,function(x) sum(x=="-",na.rm=T))
apply(data,MARGIN = 2,function(x) sum(x=="",na.rm=T))
apply(data,MARGIN = 2,function(x) sum(x==" ",na.rm=T))
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
data$Satisfaction<-as.factor(data$Satisfaction)
str(data)
ggplot(data,aes(x=Seat.Comfort,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Gate.Location,fill=Satisfaction)))+geom_bar(position = "fill")
ggplot(data,aes(x=Gate.Location,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Departure.and.Arrival.Time.Convenience,fill=Satisfaction))+geom_bar(position = "fill")
data$Departure.and.Arrival.Time.Convenience<as.factor(data$Departure.and.Arrival.Time.Convenience)
data$Departure.and.Arrival.Time.Convenience<-as.factor(data$Departure.and.Arrival.Time.Convenience)
ggplot(data,aes(x=Departure.and.Arrival.Time.Convenience,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Ease.of.Online.Booking,fill=Satisfaction))+geom_bar(position = "fill")
data$Ease.of.Online.Booking<-as.factor(data$Ease.of.Online.Booking)
source("~/.active-rstudio-document", echo=TRUE)
data$Ease.of.Online.Booking<-as.factor(data$Ease.of.Online.Booking)
ggplot(data,aes(x=Ease.of.Online.Booking,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Baggage.Handling,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=In.flight.Entertainment,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Baggage.Handling,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=In.flight.Wifi.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Leg.Room.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Arrival.Delay,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Arrival.Delay,fill=Satisfaction))+geom_density(alpha=0.5)
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
#Varijabla ID ima 129880 razlicitih vrednosti, sto je jednako broju opservacija
#Ova varijabla je dakle jedinstvena za svaku opservaciju i ne moze direktno uticati na zadovoljstvo putnika
#Stoga je odmah izbacujemo iz daljeg razmatranja
length(unique(data$ID))
data$ID<-NULL
#varijabla Gender(pol putnika) ima 2  razlicite vrednosti(Female i Male), dakle pretvaramo varijablu u faktorsku
#takodje vidimo da je prilicno dobro uravnotezen broj zena i muskaraca u dataset-u,
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#Varijabla Age(predstavlja broj godina putnika) sadrzi 75 razlicitih vrednosti
#Sadrzi putnike starosti 7-80 godina, kao i 25 putnika starosti 85 godina
length(unique(data$Age))
table(data$Age)
#Varijabla Customer.Type sadrzi 2 vrednosti(First-time i Returning),dakle pretvaramo varijablu u faktorsku
#pri cemu znacajno vise putnika pripada tipu Returning
#Returning su putnici koji su vec putovali aviokompanijom
length(unique(data$Customer.Type))
table(data$Customer.Type)
data$Customer.Type<-as.factor(data$Customer.Type)
#Varijabla Type.of.Travel sadrzi 2 vrednosti Business i Personal, dakle pretvaramo varijablu u faktorsku
#(vise od duplo vise putnika leti iz poslovnih razloga(Business))
length(unique(data$Type.of.Travel))
table(data$Type.of.Travel)
data$Type.of.Travel<-as.factor(data$Type.of.Travel)
#Varijabla Class sadrzi 3 razlicite vrednosti(Business,Economy i Economy Plus)
length(unique(data$Class))
table(data$Class)
#ova varijabla je ordinalna, tako da cemo je zadrzati i pretvoriti u faktorsku iako nije binarna
data$Class<-factor(data$Class, levels=c("Economy","Economy Plus","Business"))
#numericka varijabla sa 3821 razlicite vrednosti (predstavlja duzinu leta izrazenu u miljama)
length(unique(data$Flight.Distance))
#numericka varijabla sa 466 razlicitih vrednosti (predstavlja kasnjenje prilikom poletanja sa aerodroma izrazeno u minutima)
length(unique(data$Departure.Delay))
#numericka varijabla sa 473 razlicite vrednosti (predstavlja kasnjenje prilikom sletanja na aerodrom izrazeno u minutima)
length(unique(data$Arrival.Delay))
#naredne varijable (od Departure and Arrival convience do Baggage Handling) su predstavljene brojevima 0-5,
#0 vrednosti su "not applicable" tj NA, a 1-5 su ocene od najnize do najvise
#kod svake od narednih varijabli cemo vrednosti 0 prvo proglasiti kao NA vrednosti, pa potom zameniti sa medijanom
#Ne moramo raditi Shapiro-test za utvrdjivanje raspodele za svaku varijablu posebno, jer je srednja vrednost kod varijabli sa normalnom raspodelom zapravo jednaka medijani
#Ukoliko bismo radili Shapiro-test, broj opservacija u ovom dataset-u visestruko prevazilazi maksimalnih 5000 koje taj test dozvoljava, tako da bismo radili samo na uzorku od 5000 opservacija
#Iako mozemo sve naredne varijable pretvoriti u faktorske sa 5 nivoa, to ne moramo raditi jer
#KNN algoritam zahteva iskljucivo numericke ulazne varijable pa su nam trenutno pogodne u ovom formatu
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
data$Departure.and.Arrival.Time.Convenience[data$Departure.and.Arrival.Time.Convenience==0]<-NA
data$Departure.and.Arrival.Time.Convenience[is.na(data$Departure.and.Arrival.Time.Convenience)]<-median(data$Departure.and.Arrival.Time.Convenience, na.rm=T)
length(unique(data$Ease.of.Online.Booking))
table(data$Ease.of.Online.Booking)
data$Ease.of.Online.Booking[data$Ease.of.Online.Booking==0]<-NA
data$Ease.of.Online.Booking[is.na(data$Ease.of.Online.Booking)]<-median(data$Ease.of.Online.Booking, na.rm=T)
length(unique(data$Check.in.Service))
table(data$Check.in.Service)
data$Check.in.Service[data$Check.in.Service==0]<-NA
data$Check.in.Service[is.na(data$Check.in.Service)]<-median(data$Check.in.Service, na.rm=T)
length(unique(data$Online.Boarding))
table(data$Online.Boarding)
data$Online.Boarding[data$Online.Boarding==0]<-NA
data$Online.Boarding[is.na(data$Online.Boarding)]<-median(data$Online.Boarding, na.rm=T)
length(unique(data$Gate.Location))
table(data$Gate.Location)
data$Gate.Location[data$Gate.Location==0]<-NA
data$Gate.Location[is.na(data$Gate.Location)]<-median(data$Gate.Location, na.rm=T)
length(unique(data$On.board.Service))
table(data$On.board.Service)
data$On.board.Service[data$On.board.Service==0]<-NA
data$On.board.Service[is.na(data$On.board.Service)]<-median(data$On.board.Service, na.rm=T)
length(unique(data$Seat.Comfort))
table(data$Seat.Comfort)
data$Seat.Comfort[data$Seat.Comfort==0]<-NA
data$Seat.Comfort[is.na(data$Seat.Comfort)]<-median(data$Seat.Comfort, na.rm=T)
length(unique(data$Leg.Room.Service))
table(data$Leg.Room.Service)
data$Leg.Room.Service[data$Leg.Room.Service==0]<-NA
data$Leg.Room.Service[is.na(data$Leg.Room.Service)]<-median(data$Leg.Room.Service, na.rm=T)
length(unique(data$Cleanliness))
table(data$Cleanliness)
data$Cleanliness[data$Cleanliness==0]<-NA
data$Cleanliness[is.na(data$Cleanliness)]<-median(data$Cleanliness, na.rm=T)
length(unique(data$Food.and.Drink))
table(data$Food.and.Drink)
data$Food.and.Drink[data$Food.and.Drink==0]<-NA
data$Food.and.Drink[is.na(data$Food.and.Drink)]<-median(data$Food.and.Drink, na.rm=T)
length(unique(data$In.flight.Service))
table(data$In.flight.Service)
data$In.flight.Service[data$In.flight.Service==0]<-NA
data$In.flight.Service[is.na(data$In.flight.Service)]<-median(data$In.flight.Service, na.rm=T)
length(unique(data$In.flight.Wifi.Service))
table(data$In.flight.Wifi.Service)
data$In.flight.Wifi.Service[data$In.flight.Wifi.Service==0]<-NA
data$In.flight.Wifi.Service[is.na(data$In.flight.Wifi.Service)]<-median(data$In.flight.Wifi.Service, na.rm=T)
length(unique(data$In.flight.Entertainment))
table(data$In.flight.Entertainment)
data$In.flight.Entertainment[data$In.flight.Entertainment==0]<-NA
data$In.flight.Entertainment[is.na(data$In.flight.Entertainment)]<-median(data$In.flight.Entertainment, na.rm=T)
length(unique(data$Baggage.Handling))
table(data$Baggage.Handling)
data$Baggage.Handling[data$Baggage.Handling==0]<-NA
data$Baggage.Handling[is.na(data$Baggage.Handling)]<-median(data$Baggage.Handling, na.rm=T)
table(data$Baggage.Handling)
table(data$In.flight.Entertainment)
table(data$In.flight.Wifi.Service)
table(data$Food.and.Drink)
str(data)
#ucitavanje dataset-a
data=read.csv("airline_passenger_satisfaction.csv",stringsAsFactors = F)
#ucitavanje potrebnih paketa
library(ggplot2)
library(caret)
#ispitivanje strukure dataset-a
#(pomocu summary() ne mozemo dobiti osnovne informacije za character varijable)
str(data)
summary(data)
#Varijabla ID ima 129880 razlicitih vrednosti, sto je jednako broju opservacija
#Ova varijabla je dakle jedinstvena za svaku opservaciju i ne moze direktno uticati na zadovoljstvo putnika
#Stoga je odmah izbacujemo iz daljeg razmatranja
length(unique(data$ID))
data$ID<-NULL
#varijabla Gender(pol putnika) ima 2  razlicite vrednosti(Female i Male), dakle pretvaramo varijablu u faktorsku
#takodje vidimo da je prilicno dobro uravnotezen broj zena i muskaraca u dataset-u,
length(unique(data$Gender))
table(data$Gender)
data$Gender<-as.factor(data$Gender)
#Varijabla Age(predstavlja broj godina putnika) sadrzi 75 razlicitih vrednosti
#Sadrzi putnike starosti 7-80 godina, kao i 25 putnika starosti 85 godina
length(unique(data$Age))
table(data$Age)
#Varijabla Customer.Type sadrzi 2 vrednosti(First-time i Returning),dakle pretvaramo varijablu u faktorsku
#pri cemu znacajno vise putnika pripada tipu Returning
#Returning su putnici koji su vec putovali aviokompanijom
length(unique(data$Customer.Type))
table(data$Customer.Type)
data$Customer.Type<-as.factor(data$Customer.Type)
#Varijabla Type.of.Travel sadrzi 2 vrednosti Business i Personal, dakle pretvaramo varijablu u faktorsku
#(vise od duplo vise putnika leti iz poslovnih razloga(Business))
length(unique(data$Type.of.Travel))
table(data$Type.of.Travel)
data$Type.of.Travel<-as.factor(data$Type.of.Travel)
#Varijabla Class sadrzi 3 razlicite vrednosti(Business,Economy i Economy Plus)
length(unique(data$Class))
table(data$Class)
#ova varijabla je ordinalna, tako da cemo je zadrzati i pretvoriti u faktorsku iako nije binarna
data$Class<-factor(data$Class, levels=c("Economy","Economy Plus","Business"))
#numericka varijabla sa 3821 razlicite vrednosti (predstavlja duzinu leta izrazenu u miljama)
length(unique(data$Flight.Distance))
#numericka varijabla sa 466 razlicitih vrednosti (predstavlja kasnjenje prilikom poletanja sa aerodroma izrazeno u minutima)
length(unique(data$Departure.Delay))
#numericka varijabla sa 473 razlicite vrednosti (predstavlja kasnjenje prilikom sletanja na aerodrom izrazeno u minutima)
length(unique(data$Arrival.Delay))
#naredne varijable (od Departure and Arrival convience do Baggage Handling) su predstavljene brojevima 0-5,
#0 vrednosti su "not applicable" tj NA, a 1-5 su ocene od najnize do najvise
#kod svake od narednih varijabli cemo vrednosti 0 prvo proglasiti kao NA vrednosti, pa potom zameniti sa medijanom
#Ne moramo raditi Shapiro-test za utvrdjivanje raspodele za svaku varijablu posebno, jer je srednja vrednost kod varijabli sa normalnom raspodelom zapravo jednaka medijani
#Ukoliko bismo radili Shapiro-test, broj opservacija u ovom dataset-u visestruko prevazilazi maksimalnih 5000 koje taj test dozvoljava, tako da bismo radili samo na uzorku od 5000 opservacija
#Iako mozemo sve naredne varijable pretvoriti u faktorske sa 5 nivoa, to ne moramo raditi jer
#KNN algoritam zahteva iskljucivo numericke ulazne varijable pa su nam trenutno pogodne u ovom formatu
length(unique(data$Departure.and.Arrival.Time.Convenience))
table(data$Departure.and.Arrival.Time.Convenience)
data$Departure.and.Arrival.Time.Convenience[data$Departure.and.Arrival.Time.Convenience==0]<-NA
data$Departure.and.Arrival.Time.Convenience[is.na(data$Departure.and.Arrival.Time.Convenience)]<-median(data$Departure.and.Arrival.Time.Convenience, na.rm=T)
length(unique(data$Ease.of.Online.Booking))
table(data$Ease.of.Online.Booking)
data$Ease.of.Online.Booking[data$Ease.of.Online.Booking==0]<-NA
data$Ease.of.Online.Booking[is.na(data$Ease.of.Online.Booking)]<-median(data$Ease.of.Online.Booking, na.rm=T)
length(unique(data$Check.in.Service))
table(data$Check.in.Service)
data$Check.in.Service[data$Check.in.Service==0]<-NA
data$Check.in.Service[is.na(data$Check.in.Service)]<-median(data$Check.in.Service, na.rm=T)
length(unique(data$Online.Boarding))
table(data$Online.Boarding)
data$Online.Boarding[data$Online.Boarding==0]<-NA
data$Online.Boarding[is.na(data$Online.Boarding)]<-median(data$Online.Boarding, na.rm=T)
length(unique(data$Gate.Location))
table(data$Gate.Location)
data$Gate.Location[data$Gate.Location==0]<-NA
data$Gate.Location[is.na(data$Gate.Location)]<-median(data$Gate.Location, na.rm=T)
length(unique(data$On.board.Service))
table(data$On.board.Service)
data$On.board.Service[data$On.board.Service==0]<-NA
data$On.board.Service[is.na(data$On.board.Service)]<-median(data$On.board.Service, na.rm=T)
length(unique(data$Seat.Comfort))
table(data$Seat.Comfort)
data$Seat.Comfort[data$Seat.Comfort==0]<-NA
data$Seat.Comfort[is.na(data$Seat.Comfort)]<-median(data$Seat.Comfort, na.rm=T)
length(unique(data$Leg.Room.Service))
table(data$Leg.Room.Service)
data$Leg.Room.Service[data$Leg.Room.Service==0]<-NA
data$Leg.Room.Service[is.na(data$Leg.Room.Service)]<-median(data$Leg.Room.Service, na.rm=T)
length(unique(data$Cleanliness))
table(data$Cleanliness)
data$Cleanliness[data$Cleanliness==0]<-NA
data$Cleanliness[is.na(data$Cleanliness)]<-median(data$Cleanliness, na.rm=T)
length(unique(data$Food.and.Drink))
table(data$Food.and.Drink)
data$Food.and.Drink[data$Food.and.Drink==0]<-NA
data$Food.and.Drink[is.na(data$Food.and.Drink)]<-median(data$Food.and.Drink, na.rm=T)
length(unique(data$In.flight.Service))
table(data$In.flight.Service)
data$In.flight.Service[data$In.flight.Service==0]<-NA
data$In.flight.Service[is.na(data$In.flight.Service)]<-median(data$In.flight.Service, na.rm=T)
length(unique(data$In.flight.Wifi.Service))
table(data$In.flight.Wifi.Service)
data$In.flight.Wifi.Service[data$In.flight.Wifi.Service==0]<-NA
data$In.flight.Wifi.Service[is.na(data$In.flight.Wifi.Service)]<-median(data$In.flight.Wifi.Service, na.rm=T)
length(unique(data$In.flight.Entertainment))
table(data$In.flight.Entertainment)
data$In.flight.Entertainment[data$In.flight.Entertainment==0]<-NA
data$In.flight.Entertainment[is.na(data$In.flight.Entertainment)]<-median(data$In.flight.Entertainment, na.rm=T)
length(unique(data$Baggage.Handling))
table(data$Baggage.Handling)
data$Baggage.Handling[data$Baggage.Handling==0]<-NA
data$Baggage.Handling[is.na(data$Baggage.Handling)]<-median(data$Baggage.Handling, na.rm=T)
#predstavlja izlaznu varijablu, odnosno zadovoljstvo putnika avikompanijom
#Moze imati 2 vrednosti (Satisfied i Neutral or Dissatisfied), pretvaramo je u faktorsku
length(unique(data$Satisfaction))
data$Satisfaction<-as.factor(data$Satisfaction)
str(data)
table(data$In.flight.Entertainment)
apply(data,MARGIN = 2,function(x) sum(is.na(x)))
apply(data,MARGIN = 2,function(x) sum(x=="-",na.rm=T))
apply(data,MARGIN = 2,function(x) sum(x=="",na.rm=T))
apply(data,MARGIN = 2,function(x) sum(x==" ",na.rm=T))
#Vidimo da varijabla Arrival.Delay sadrzi 393 NA vrednosti tako da cemo te vrednosti zameniti medijanom
data$Arrival.Delay[is.na(data$Arrival.Delay)]<-median(data$Arrival.Delay, na.rm=T)
#provera nedostajucih vrednosti za sve varijable
apply(data,MARGIN = 2,function(x) sum(is.na(x)))
ggplot(data,aes(x=Age,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Gender,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Gender,fill=Satisfaction))+geom_bar(position = "dodge")
#ne postoji znacajna razlika u polu
ggplot(data,aes(x=Gender,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Customer.Type,fill=Satisfaction)))+geom_bar(position = "fill")
ggplot(data,aes(x=Customer.Type,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Customer.Type,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Type.of.Travel,fill=Satisfaction)))+geom_bar(position = "fill")
ggplot(data,aes(x=Type.of.Travel,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Class,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Flight.Distance,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Departure.Delay,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Arrival.Delay,fill=Satisfaction))+geom_density(alpha=0.5)
ggplot(data,aes(x=Departure.and.Arrival.Time.Convenience,fill=Satisfaction))+geom_bar(position = "fill")
#?
ggplot(data,aes(x=Departure.and.Arrival.Time.Convenience,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Ease.of.Online.Booking,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Check.in.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Gate.Location,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=On.board.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Seat.Comfort,fill=Satisfaction))+geom_bar(position = "fill")
o
ggplot(data,aes(x=Leg.Room.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Cleanliness,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Food.and.Drink,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=In.flight.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=In.flight.Wifi.Service,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=In.flight.Entertainment,fill=Satisfaction))+geom_bar(position = "fill")
ggplot(data,aes(x=Baggage.Handling,fill=Satisfaction))+geom_bar(position = "fill")
